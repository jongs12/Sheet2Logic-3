# Sheet2Logic 3

[개요]
---
[Mindustry](https://github.com/Anuken/Mindustry)의 모드 중 하나인 [Betamindy](https://github.com/sk7725/BetaMindy)의 노트블럭을 연주하는 로직 코드를 쉽게 짜주는 [프로그램](https://github.com/jongs12/Midi2Logic-2)을 또 한 번 개선한 버전입니다.

이 프로그램을 사용하려면 [파이썬](https://github.com/python)이 필요합니다.

급하게 만들어서 버그가 있을 수 있습니다. 사용에 유의하세요.

[사용법]
---
![1](https://github.com/user-attachments/assets/1e781b15-1cfb-4e11-a18a-b6732a3a0a96)

우선 프로그램이 읽을 txt 파일을 작성합니다. 인코딩 방식은 UTF-8을 권장합니다.

사진처럼 한 줄의 처음에 숫자만 입력하면 BPM을 변경하고, 계이름과 숫자를 입력하면 해당 옥타브의 음을 연주하도록 합니다.
한 칸을 띄우고 입력한 수는 BPM 변경이나 음 연주 후 몇 **박자** 쉴지를, 사실상 음의 길이를 결정합니다.

프로그램이 계이름으로 인식하는 것은 라0부터 도8까지이며, 음정 조절 후 실질적으로 연주할 수 있는 음은 도1부터 시7까지입니다.
한 줄의 처음이 무슨 내용인지 인식하지 못했을 때도 한 칸 뒤에 수가 있다면 여전히 해당 박자만큼 쉽니다.

![2](https://github.com/user-attachments/assets/05b3c154-7922-4164-ad5a-094825e7241e)

각 '트랙'별로 txt 파일을 만들어 하나의 폴더에 넣습니다.
이후 로직 코드로 변환 시 특별히 지정하지 않으면 모든 트랙은 동시에 연주를 시작합니다.

![3](https://github.com/user-attachments/assets/e64b96aa-eff3-44b6-8c12-5a0bcc50c6aa)

프로그램을 실행하면 사진과 같이 텍스트가 표시됩니다.
이전에 txt 파일을 저장한 **폴더**의 이름을 입력합니다.

프로그램이 저장된 위치와 같은 곳에 폴더가 있다면 이름만 입력해도 되지만, 아니라면 폴더의 경로도 포함하여 입력해야 합니다.

![4](https://github.com/user-attachments/assets/50d8e7e5-d0a0-4820-8aa7-af7dc9db017a)

제대로 입력했다면 각 트랙별로 반복 횟수, 음정 조절, 속도 조절, 시작 오프셋, 반복 딜레이를 입력받습니다.

로직 코드에 포함시키고 싶지 않은 파일이 있을 경우 반복 횟수에 0을 입력하면 됩니다.

음정 조절은 0.5 단위로 입력합니다. 예를 들어 -1.5를 입력했다면 미4는 도#4처럼 인식됩니다.

속도 조절은 박자를 나누는 방식입니다. 만약 2를 입력했다면 원래 4박을 연주하는 음이 2박만 연주하는 것처럼 인식됩니다.

시작 오프셋은 속도 조절의 영향을 받지 않습니다.
즉 트랙의 시작 오프셋을 4박으로 설정했다면 속도를 2배로 하더라도 여전히 4박 후에 시작합니다.

반복 딜레이는 반복 횟수가 2 이상일 때만 입력받습니다. 아까와 달리 속도 조절의 영향은 받지만,
시작 오프셋의 영향은 받지 않아, 속도가 1이라고 했을 때 반복 딜레이가 8이라면 시작 오프셋에 관계없이 8박 후 다시 시작합니다.

숫자를 제대로 입력하지 않으면(속도를 음수로 지정하는 등) 자동으로 기본값으로 설정됩니다.

![5](https://github.com/user-attachments/assets/d00f9acd-785d-495d-ba22-3ac1ff37c45a)

이후에는 해당 트랙의 악기를 드럼으로 고정할지 묻습니다.
y 또는 Y를 입력한다면 로직에서 해당 트랙을 연주하는 블록은 악기 변경 스위치의 영향을 받지 않습니다.
아무것도 입력하지 않으면 n을 입력한 것과 같이 진행합니다.

![6](https://github.com/user-attachments/assets/55d66c4f-378f-4944-8481-0cbc6deb2682)

모든 트랙에 대해 입력을 완료하면, 변환된 로직 코드를 어떤 폴더에 저장할지 묻습니다.

방식은 이전에 트랙이 저장된 폴더의 이름을 입력했던 것과 같습니다.
프로그램이 저장된 위치와 같은 곳에 폴더가 있다면 이름만 입력해도 되지만, 아니라면 폴더의 경로도 포함하여 입력해야 합니다.
다만 파이썬의 한계로, 이미 존재하는 폴더의 이름만 입력할 수 있습니다.

만약 해당 폴더에 저장하려는 파일과 이름이 같은 파일이 이미 있다면 한번 더 물어봅니다.
y 또는 Y를 입력하지 않으면 n으로 인식하고 다시 입력받습니다.

![7](https://user-images.githubusercontent.com/99316134/201531628-52994e37-81de-4e37-9113-ec4380f878cc.PNG)

파일이 저장되었다면, Mindustry를 켜고 편집기로 들어가서 midi.msav 파일을 불러와줍니다.

![8](https://user-images.githubusercontent.com/99316134/201531630-1d976157-999c-4808-8b4e-3237f90e6f90.PNG)

맵의 편집기를 열고, esc를 눌러서 인 게임 편집으로 가줍니다.

![9](https://user-images.githubusercontent.com/99316134/201531631-b822825e-16d7-4da6-add1-b8c3e5ce2f52.PNG)

맵 구성은 기본적으로 이렇게 되어 있습니다. 그냥 사용하셔도 되지만 필요하다면 수정해도 상관없습니다.

![10](https://user-images.githubusercontent.com/99316134/201531633-0e4ce713-9c7e-470c-9c7e-63b14817f852.PNG)

프로세서 중 하나는 반드시 트랙 수만큼의 노트블록과 스위치 3개, 메모 블록과 메모리 셀 각각 1개에 연결되어 있어야 합니다.
switch1은 연주 시작, switch2와 switch3은 악기 변경 스위치로 동작합니다.

하나의 프로세서에는 코드를 1000줄까지만 작성할 수 있다는 한계가 존재하여, 트랙은 최대 963개까지만 넣을 수 있습니다.

![11](https://github.com/user-attachments/assets/4511d4ba-6acd-4b6f-9a9c-05808b9d9c9a)

해당 프로세서에 아까 저장되었던 page 0 파일의 내용을 붙여넣습니다.

![12](https://user-images.githubusercontent.com/99316134/201531645-f17ebacd-7449-4f33-aeda-a7abc0c2a8c6.PNG)

그 외에도 노트블록과 메모리 셀에 연결된 프로세서를 page 0을 제외한 페이지 수만큼 준비합니다.

![13](https://github.com/user-attachments/assets/df8ed915-47ae-448d-b2e0-9388439cb643)

각 페이지의 내용을 아까와 같이 붙여넣습니다.

![14](https://user-images.githubusercontent.com/99316134/201531647-4898761d-f98d-4001-b9bd-f3ac337d0efa.PNG)

다 했으면 ~~맵을 좀 꾸미고 나서~~ 저장하고 나와줍니다.

![15](https://user-images.githubusercontent.com/99316134/201531651-b2d498cd-3cbb-4863-a443-c975c2476aae.PNG)

사용자 지정 게임을 시작해서 감상하시면 됩니다.
